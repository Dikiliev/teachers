{% extends "base.html" %}

{% block head %}
    <link type="text/css" rel="stylesheet" href="{{ static('css/form.css') }}">
    <link type="text/css" rel="stylesheet" href="{{ static('css/manage_groups.css') }}">

    <script type="text/javascript" src="{{ static('js/teachers.js') }}" defer></script>

    <script>
        const user_id = {{ user.id }};
    </script>
{% endblock %}

{% block content %}
    <br>
    <div class="container">
        <h1>Мои группы</h1>

        <form class="" action="" method="post">

            {% for group in groups %}
                <h2>Группа {{ loop.index }}</h2>

                <div class="group">
                    <div class="group-fields">
                        <div class="input-group">
                            <label for="name">Название группы:</label>
                            <input type="text" id="name" name="name" value="{{ group.name }}" required>
                        </div>

                        <div class="input-group">
                            <label for="price">Цена в месяц:</label>
                            <input type="number" id="price" name="price" value="{{ group.price }}" required>
                        </div>

                        <div class="input-group">
                            <label for="category">Предмет:</label>
                            <select name="category" id="category" required>
                                <option value="0"> -- Не выбрано -- </option>
                                {% for subject in subjects %}
                                    <option {% if subject == group.subject %} selected {% endif %} value="{{ subject.id }}">{{ subject.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                <div class="schedules-list">

                    {% for schedule in group.schedules.all() %}
                        <div class="schedule">
                            <h3>Урок {{ loop.index }}</h3>

                            <div class="schedule-fields">
                                <div class="input-group">
                                    <label for="day_of_week">День недели:</label>
                                    <select id="day_of_week" name="day_of_week" required>
                                        <option value="0"> -- Не выбрано -- </option>
                                        {% for day, day_name in schedule.DAYS_OF_WEEK %}
                                            <option {% if day == schedule.day_of_week %} selected {% endif %} value="{{ day }}">{{ day_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="input-group">
                                    <label for="start_time">Время начала:</label>
                                    <input type="time" id="start_time" name="start_time" value="{{ schedule.start_time }}" required>
                                </div>

                                <div class="input-group">
                                    <label for="duration">Длительность (в минутах):</label>
                                    <input type="number" id="duration" name="duration" value="{{ (schedule.duration.total_seconds() / 60) | int }}" required>
                                </div>
                            </div>
                        </div>
                    {% endfor %}

                </div>
            </div>

            {% endfor %}

        </form>
    </div>

{% endblock %}
